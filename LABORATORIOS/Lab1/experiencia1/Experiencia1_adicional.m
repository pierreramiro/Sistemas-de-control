clc;clear;close all;
vel2=-[0.00 -46.27 -46.27 -46.27 -46.27 -46.27 -46.27 -32.39 -70.81 -81.10 -98.06 -112.14 -130.94 -147.87 -159.44 -171.70 -184.55 -193.70 -207.41 -212.10 -223.21 -227.55 -233.21 -249.34 -249.34 -256.15 -258.98 -266.34 -266.34 -270.95 -279.02 -294.81 -289.35 -287.58 -294.81 -292.97 -306.37 -289.35 -310.43 -308.39 -304.38 -312.50 -316.72 -318.88 -323.28 -325.52 -327.80 -325.52 -325.52 -327.80 -330.11 -327.80 -330.11 -325.52 -332.45 -334.82 -339.67 -318.88 -342.15 -344.67 -342.15 -344.67 -342.15 -321.06 -339.67 -339.67 -342.15 -342.15 -344.67 -344.67 -344.67 -347.22 -347.22 -347.22 -347.22 -352.44 -347.22 -347.22 -347.22 -355.11 -352.44 -352.44 -355.11 -352.44 -355.11 -355.11 -344.67 -355.11 -355.11 -357.82 -357.82 -357.82 -357.82 -357.82 -360.58 -357.82 -357.82 -355.11 -355.11 -355.11 -355.11 -355.11 -352.44 -357.82 -366.21 -357.82 -349.81 -352.44 -352.44 -355.11 -352.44 -352.44 -357.82 -355.11 -349.81 -366.21 -352.44 -352.44 -352.44 -339.67 -357.82 -355.11 -337.23 -352.44 -352.44 -352.44 -357.82 -355.11 -355.11 -355.11 -355.11 -349.81 -355.11 -355.11 -355.11 -355.11 -355.11 -352.44 -347.22 -352.44 -352.44 -352.44 -352.44 -352.44 -360.58 -357.82 -357.82 -363.37 -352.44 -352.44 -357.82 -357.82 -357.82 -357.82 -355.11 -357.82 -357.82 -357.82 -327.80 -355.11 -355.11 -357.82 -357.82 -357.82 -355.11 -355.11 -366.21 -357.82 -357.82 -355.11 -352.44 -325.52 -349.81 -349.81 -349.81 -352.44 -325.52 -349.81 -349.81 -360.58 -349.81 -349.81 -352.44 -352.44 -352.44 -355.11 -349.81 -327.80 -352.44 -352.44 -330.11 -352.44 -355.11 -357.82 -355.11 -352.44 -366.21 -355.11 -352.44 -334.82 -357.82 -357.82 -344.67 -355.11 -352.44 -355.11 -357.82 -357.82 -357.82 -357.82 -360.58 -355.11 -357.82 -360.58 -360.58 -360.58 -360.58 -360.58 -357.82 -363.37 -360.58 -357.82 -347.22 -357.82 -357.82 -360.58 -363.37 -363.37 -360.58 -349.81 -360.58 -363.37 -363.37 -360.58 -363.37 -363.37 -344.67 -357.82 -363.37 -360.58 -363.37 -363.37 -360.58 -339.67 -360.58 -360.58 -357.82 -355.11 -363.37 -363.37 -349.81 -357.82 -357.82 -357.82 -355.11 -355.11 -355.11 -355.11 -357.82 -357.82 -360.58 -352.44 -355.11 -330.11 -352.44 -352.44 -334.82 -352.44 -352.44 -355.11 -352.44 -349.81 -349.81 -352.44 -352.44 -342.15 -349.81 -360.58 -363.37 -349.81 -355.11 -352.44 -352.44 -352.44 -352.44 -352.44 -363.37 -349.81 -349.81 -352.44 -344.67 -355.11 -355.11 -352.44 -355.11 -355.11 -357.82 -357.82 -357.82 -357.82 -357.82 -360.58 -355.11 -363.37 -357.82 -357.82 -357.82 -360.58 -355.11 -355.11 -357.82 -360.58 -360.58 -332.45 -355.11 -357.82 -332.45 -352.44 -352.44 -337.23 -355.11 -357.82 -337.23 -352.44 -352.44 -355.11 -349.81 -352.44 -349.81 -355.11 -355.11 -355.11 -352.44 -352.44 -352.44 -366.21 -355.11 -355.11 -342.15 -352.44 -352.44 -355.11 -357.82 -355.11 -357.82 -337.23 -355.11 -355.11 -352.44 -355.11 -357.82 -355.11 -332.45 -355.11 -357.82 -357.82 -357.82 -366.21 -357.82 -325.52 -357.82 -355.11 -355.11 -349.81 -357.82 -357.82 -355.11 -355.11 -355.11 -355.11 -360.58 -360.58 -357.82 -355.11 -355.11 -355.11 -355.11 -357.82 -357.82 -357.82 -349.81 -360.58 -360.58 -342.15 -360.58 -360.58 -357.82 -360.58 -357.82 -360.58 -360.58 -357.82 -357.82 -357.82 -372.02 -360.58 -357.82 -357.82 -360.58 -357.82 -355.11 -349.81 -360.58 -357.82 -355.11 -357.82 -355.11 -352.44 -347.22 -344.67 -352.44 -355.11 -349.81 -349.81 -344.67 -349.81 -347.22 -352.44 -349.81 -327.80 -349.81 -349.81 -349.81 -352.44 -352.44 -352.44 -342.15 -339.67 -352.44 -349.81 -352.44 -349.81 -349.81 -357.82 -355.11 -337.23 -357.82 -352.44 -357.82 -360.58 -357.82 -357.82 -357.82 -357.82 -360.58 -357.82 -357.82 -360.58 -360.58 -360.58 -360.58 -360.58 -360.58 -355.11 -357.82 -357.82 -357.82 -360.58 -360.58 -357.82 -357.82 -357.82 -334.82 -355.11 -363.37 -363.37 -357.82 -357.82 -360.58 -355.11 -355.11 -355.11 -352.44 -357.82 -357.82 -360.58 -355.11 -355.11 -355.11 -355.11 -355.11 -352.44 -360.58 -357.82 -355.11 -352.44 -357.82 -349.81 -352.44 -352.44 -347.22 -355.11 -355.11 -352.44 -355.11 -352.44 -352.44 -325.52 -355.11 -357.82 -355.11 -352.44 -352.44 -352.44 -363.37 -357.82 -355.11 -355.11 -355.11 -355.11 -352.44 -352.44 -355.11 -355.11 -355.11 -352.44 -355.11 -363.37 ];
vel2=vel2(1,1:500)';
Ts=0.002; %Iempo de muestra: 2 ms
u=3*ones(length(vel2),1);
t=0:Ts:(length(vel2)-1)*Ts;t=t';
%%
load ('Transfer_Function.mat');
num=tf2.Numerator;
den=tf2.Denominator;
num=num/den(2);
den=den/den(2);
Ps=tf(num,den);
display(Ps)
lsim(Ps,u',t','r')
hold
plot(t,vel2);
grid
legend('Modelo','Valores reales')
title('Respuesta del Motor')
xlabel('Tiempo')
ylabel('Velocidad motor [Â°/seg]')